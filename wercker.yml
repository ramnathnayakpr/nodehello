box: node

build:
    steps:
  
    - script:
        name: Install express 
        code: npm install express
    
    - script:
        name: Copy files over to root 
        code: cp -R /pipeline/source/* /
    
    - internal/docker-push:
        ports: 80
        cmd: "node nodehello.js" 
        username: $USERNAME
        password: $PASSWORD
        registry: https://lhr.ocir.io
        repository: lhr.ocir.io/intrnayak/nodehello
        tag: latest

deploy:
    steps:

    - kubectl:
      name: Deploy to OKE
      server: $OKE_MASTER
      token: $OKE_TOKEN
      insecure-skip-tls-verify: true
      command: apply -f deployment.yml